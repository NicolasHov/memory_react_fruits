{"version":3,"sources":["App.js","reportWebVitals.js","index.js"],"names":["Card","props","x","y","callback","state","image","onClick","style","width","height","background","objectFit","flipCard","gameState","pos","updatedGameState","Array","from","Game","useState","cards","newArray","forEach","item","_id","push","value","process","generateCards","array","i","length","j","Math","floor","random","temp","shuffle","concat","map","generateGrid","setGameState","clicksHistory","setClicksHistory","getPos","gameLaunched","setGameLaunched","counter","setCounter","useEffect","setTimeout","alert","arr","size","cardClicked","updatedLasPosCards","console","log","card","filter","revealedCards","score","myHeaders","Headers","append","raw","JSON","stringify","fetch","method","headers","body","redirect","mode","then","response","text","result","catch","error","addHighScore","ceil","v","slice","row","backgroundColor","App","top5","setTop5","highscores","scores","sort","a","b","sign","parse","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.d47d6087.chunk.js","sourcesContent":["/* eslint-disable no-unused-vars */\nimport React, { useState, useEffect } from 'react'\nimport './App.css'\n\nconst Card = props => {\n  // eslint-disable-next-line react/prop-types\n  const { x, y, callback, state, image } = props\n  return (\n    <button\n      onClick={() => callback(x, y)}\n      style={{ width: '100px', height: '100px', background: state !== 'hidden' ? `url(${image})` : 'none', objectFit: 'fill' }}\n    />\n  )\n}\n\nconst flipCard = (gameState, pos) => {\n  const updatedGameState = Array.from(gameState)\n  updatedGameState[pos].state = updatedGameState[pos].state === 'hidden' ? 'revealed' : 'hidden'\n  return updatedGameState\n}\n\nconst getHighScore = callback => {\n  const requestOptions = {\n    method: 'GET',\n    redirect: 'follow',\n    mode: 'cors'\n  }\n\n  fetch('http://localhost:3000/api/scores/', requestOptions)\n    .then(response => response.text())\n    .then(result => callback(JSON.parse(result)))\n    .catch(error => console.log('error', error))\n}\n\nconst addHighScore = score => {\n  const myHeaders = new Headers()\n  myHeaders.append('Content-Type', 'application/json')\n\n  const raw = JSON.stringify({\n    value: score\n  })\n\n  const requestOptions = {\n    method: 'POST',\n    headers: myHeaders,\n    body: raw,\n    redirect: 'follow',\n    mode: 'cors'\n  }\n\n  fetch('http://localhost:3000/api/scores/', requestOptions)\n    .then(response => response.text())\n    .then(result => console.log(result))\n    .catch(error => console.log('error', error))\n}\n\nconst Game = () => {\n  /// GENERATE BOARD ///\n\n  const generateCards = () => {\n    const fruitsArray = ['pomme-rouge', 'banane', 'orange', 'citron-vert', 'grenade', 'abricot', 'citron', 'fraise', 'pomme-verte', 'pêche', 'raisin', 'pastèque', 'prune', 'poire', 'cerise-rouge', 'framboise', 'mangue', 'cerise-jaune']\n    const newArray = []\n    fruitsArray.forEach((item, _id) => {\n      newArray.push({ state: 'hidden', value: item, image: (_id < 10) ? process.env.PUBLIC_URL + '/parts-0' + _id + '.png' : process.env.PUBLIC_URL + '/parts-' + _id + '.png' })\n    })\n    return newArray\n  }\n\n  const shuffle = (array) => {\n    for (let i = array.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1))\n      const temp = array[i]\n      array[i] = array[j]\n      array[j] = temp\n    }\n    return array\n  }\n\n  const generateGrid = () => {\n    const cards = generateCards()\n    return shuffle(cards.concat([...cards.map(x => ({ ...x }))]))\n  }\n\n  const [gameState, setGameState] = useState(generateGrid())\n  const [clicksHistory, setClicksHistory] = useState([])\n\n  const WIDTH = 6 // width of game board\n  const getPos = (x, y) => x * WIDTH + y // to convert position to one dimension tab\n\n  /// TIMER LOGIC ///\n\n  const TIME = 60 // time limit to play\n\n  const [gameLaunched, setGameLaunched] = useState(false)\n  const [counter, setCounter] = useState(TIME)\n\n  useEffect(() => {\n    if (!gameLaunched) {\n      return\n    }\n    if (counter > 0) {\n      setTimeout(() => setCounter(counter - 1), 1000)\n    } else {\n      alert('YOU LOSE!')\n      setGameLaunched(false)\n      setCounter(TIME)\n      // TODO: regenerate\n    }\n  }, [gameLaunched, counter])\n\n  /// PLAYER ACTION ///\n\n  const cardClicked = (x, y) => {\n    setGameLaunched(true)\n    setClicksHistory(() => {\n      const updatedLasPosCards = Array.from(clicksHistory)\n      updatedLasPosCards.push([x, y])\n      console.log('updatedLasPosCards :', updatedLasPosCards)\n      return updatedLasPosCards\n    })\n    const pos = getPos(x, y)\n    const card = gameState[pos]\n\n    if (card.state === 'removed') {\n      return // do nothing if the card is alredy removed\n    }\n\n    if (gameState.filter(card => card.state === 'revealed').length >= 2 && card.state === 'hidden') {\n      return // do nothing if there is 2 card already revealed & the card on which I clicked is hidden\n    }\n\n    setGameState(flipCard(gameState, pos))\n    const revealedCards = gameState.filter(card => card.state === 'revealed')\n    if (revealedCards.length === 2) {\n      if (revealedCards[0].value === revealedCards[1].value) {\n        revealedCards.forEach(card => { card.state = 'removed' })\n        setClicksHistory([])\n      } else { // automatically flip back the two cards revealed when they are differents\n        setTimeout(() => {\n          setGameState(flipCard(gameState, pos))\n          setGameState(flipCard(gameState, getPos(clicksHistory[0][0], clicksHistory[0][1])))\n          setClicksHistory([])\n        }, 1000)\n      }\n    }\n\n    if (gameState.filter(card => card.state === 'removed').length === gameState.length) {\n      addHighScore(counter)\n      alert('YOU WIN! Score: ' + counter)\n    }\n  }\n\n  const chunk = (arr, size) =>\n    Array.from({ length: Math.ceil(arr.length / size) }, (v, i) =>\n      arr.slice(i * size, i * size + size)\n    )\n\n  return (\n    <>\n      <div>\n        {chunk(gameState, WIDTH).map((row, i) => <div key={i}>{row.map((item, j) =>\n          <Card key={getPos(i, j)} x={i} y={j} value={item.value} callback={cardClicked} state={item.state} image={item.image} />\n        )}</div>)}\n      </div>\n      <div>Countdown: {counter}</div>\n      <div style={{ width: ((TIME - counter) * 0.6) + 'rem', height: '3rem', backgroundColor: 'red' }} />\n    </>\n  )\n}\n\nconst App = () => {\n  const [top5, setTop5] = useState([])\n\n  getHighScore(highscores => {\n    if (top5.length) return\n    setTop5(highscores.scores.sort((a, b) => Math.sign(b.value - a.value)).slice(0, 5))\n  })\n\n  return (\n    <>\n      <div>\n        <h1>Memory</h1>\n        <h2>Last Scores</h2>\n        <ul>{top5.map(x => (<li key={x._id}>{x.value}</li>))}</ul>\n      </div>\n      <Game />\n    </>\n  )\n}\n\nexport default App\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry)\n      getFID(onPerfEntry)\n      getFCP(onPerfEntry)\n      getLCP(onPerfEntry)\n      getTTFB(onPerfEntry)\n    })\n  }\n}\n\nexport default reportWebVitals\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport reportWebVitals from './reportWebVitals'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}